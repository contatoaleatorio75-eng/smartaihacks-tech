---
import Layout from '../layouts/Layout.astro';
import ArticleCard from '../components/ArticleCard.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const welcomePost = allPosts.find(p => p.slug === 'welcome');
const otherPosts = allPosts
	.filter(post => {
		const today = new Date();
		today.setHours(23, 59, 59, 999);
		// Exclude library posts and welcome post
		return post.slug !== 'welcome' && !post.id.startsWith('library/') && post.data.pubDate <= today;
	})
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const posts = welcomePost ? [welcomePost, ...otherPosts] : otherPosts;
---

<Layout title="Home">
	<section class="mb-12 text-center py-12 bg-gradient-to-b from-darker to-transparent rounded-2xl border border-gray-800">
		<h1 class="text-4xl md:text-6xl font-extrabold mb-4">
			<span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Smart AI</span> & Finance
		</h1>
		<p class="text-xl text-gray-400 max-w-2xl mx-auto">
			Unlock the power of Artificial Intelligence to revolutionize your financial productivity using tools like ChatGPT and Gemini.
		</p>
	</section>



	<section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
		{posts.map((post) => (
			<ArticleCard post={post} />
		))}
	</section>

    <section class="mt-16 text-center">
        <div class="inline-block p-[1px] rounded-2xl bg-gradient-to-r from-primary via-accent to-secondary">
            <div class="bg-darker rounded-2xl px-12 py-10 border border-gray-800/50">
                <h2 class="text-2xl font-bold mb-4 text-white">Looking for more?</h2>
                <p class="text-gray-400 mb-8 max-w-md mx-auto">
                    Explore our full archive of over 40 articles covering AI automation, financial hacks, and productivity secrets.
                </p>
                <a href="/library" class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-primary to-secondary text-white font-bold rounded-xl hover:scale-105 transition-transform shadow-lg shadow-primary/20">
                    Visit the Library
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0l-7 7m7-7l-7-7" />
                    </svg>
                </a>
            </div>
        </div>
    </section>
    
    {posts.length === 0 && (
        <div class="text-center py-20">
            <p class="text-gray-500">No articles found. Coming soon!</p>
        </div>
    )}


</Layout>
